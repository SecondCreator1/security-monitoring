<!DOCTYPE html>
<html lang="en">
<head>
    <title>Security Alerts</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h1 class="mb-4 text-danger">Security Alerts</h1>
    <table class="table table-striped" id="alerts-table">
        <thead>
            <tr>
                <th>Time</th>
                <th>User</th>
                <th>IP</th>
                <th>Action</th>
                <th>Severity</th>
                <th>Message</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
fetch('/alerts')
  .then(r => r.json())
  .then(data => {
      let rows = "";
      data.alerts.forEach(a => {
          rows += `<tr>
            <td>${a.timestamp}</td>
            <td>${a.username || ''}</td>
            <td>${a.source_ip || ''}</td>
            <td>${a.action || ''}</td>
            <td>${a.severity}</td>
            <td>${a.message}</td>
          </tr>`;
      });
      document.querySelector('#alerts-table tbody').innerHTML = rows;
  });
</script>
</body>
</html>
