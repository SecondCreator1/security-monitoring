<!DOCTYPE html>
<html lang="en">
<head>
    <title>Search Security Logs</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h1 class="mb-4">Search Logs</h1>
    <form class="mb-4">
        <input type="text" id="searchQuery" placeholder="Enter search..." class="form-control">
        <button type="button" class="btn btn-info mt-2" onclick="runSearch()">Search</button>
    </form>
    <table class="table" id="search-table">
        <thead>
            <tr><th>User</th><th>Action</th><th>Severity</th><th>Resource</th><th>Time</th></tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
<script>
function runSearch() {
    let q = document.getElementById('searchQuery').value;
    fetch('/search?q=' + encodeURIComponent(q) + '&size=50')
    .then(r => r.json())
    .then(data => {
        let body = "";
        data.results.forEach(log => {
            body += `<tr>
              <td>${log.username}</td>
              <td>${log.action}</td>
              <td>${log.severity}</td>
              <td>${log.resource}</td>
              <td>${log.timestamp}</td>
            </tr>`;
        });
        document.querySelector("#search-table tbody").innerHTML = body;
    });
}
</script>
</body>
</html>
